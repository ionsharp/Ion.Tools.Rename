<i:AppToolView x:Class="Ion.Tools.Rename.AppView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i="http://i.on/wpf" 
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:Ion.Tools.Rename"
    mc:Ignorable="d"
    MaxHeight="720"
    Title="Rename" 
    ResizeMode="NoResize"
    SizeToContent="Height"
    Style="{DynamicResource {x:Type i:AppToolView}}"
    Width="720"
    WindowStartupLocation="CenterScreen">
    <Grid i:XGrid.AutoRows="True"
        i:XGrid.Rows="Auto,*,Auto"
        i:XPanel.Spacing="0,0,0,10"
        Margin="10">
        <i:ResultControl Content="{Binding Result}"
            Visibility="{i:Bind Result, Convert=i:ConvertObjectToVisibility}"/>
        
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid i:XGrid.AutoRows="True"
                i:XGrid.Rows="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto"
                i:XPanel.Spacing="0,0,0,5">
                <Label FontWeight="Bold">Folder path</Label>
                <i:PathBox Text="{Binding FolderPath, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    CanBrowse="True"
                    BrowseMode="OpenFolder"/>

                <Label FontWeight="Bold">File extension</Label>
                <ComboBox SelectedIndex="{Binding FileExtension, Mode=TwoWay}">
                    <ComboBoxItem>Original</ComboBoxItem>
                    <ComboBoxItem>Capitalized</ComboBoxItem>
                    <ComboBoxItem>Lower</ComboBoxItem>
                    <ComboBoxItem>Upper</ComboBoxItem>
                </ComboBox>

                <Label FontWeight="Bold">File name increment base</Label>
                <ComboBox SelectedIndex="{Binding FileNameIncrementBase, Mode=TwoWay}">
                    <ComboBoxItem>Binary (2)</ComboBoxItem>
                    <ComboBoxItem>Decimal (10)</ComboBoxItem>
                    <ComboBoxItem>Hexadecimal (16)</ComboBoxItem>
                </ComboBox>

                <Label FontWeight="Bold">File name increment by</Label>
                <ComboBox SelectedIndex="{Binding FileNameIncrementBy, Mode=TwoWay}">
                    <ComboBoxItem>All</ComboBoxItem>
                    <ComboBoxItem>Extension</ComboBoxItem>
                </ComboBox>

                <Label FontWeight="Bold">File name increment start</Label>
                <i:Int32UpDown
                    Minimum="0"
                    Text="{i:Bind FileNameIncrementStart, Way=2}"/>

                <Label FontWeight="Bold">File name increment</Label>
                <i:Int32UpDown
                    Minimum="0"
                    Text="{i:Bind FileNameIncrement, Way=2}"/>

                <Label FontWeight="Bold">File sort</Label>
                <ComboBox SelectedIndex="{Binding FileSort, Mode=TwoWay}">
                    <ComboBoxItem>Accessed</ComboBoxItem>
                    <ComboBoxItem>Created</ComboBoxItem>
                    <ComboBoxItem>Extension</ComboBoxItem>
                    <ComboBoxItem>Modified</ComboBoxItem>
                    <ComboBoxItem>Name</ComboBoxItem>
                </ComboBox>

                <Label FontWeight="Bold">File sort direction</Label>
                <ComboBox SelectedIndex="{Binding FileSortDirection, Mode=TwoWay}">
                    <ComboBoxItem>Ascending</ComboBoxItem>
                    <ComboBoxItem>Descending</ComboBoxItem>
                </ComboBox>
            </Grid>
            <GridSplitter Grid.Column="1" Background="Transparent" ResizeDirection="Columns"/>
            <DataGrid Grid.Column="2" ItemsSource="{Binding Files}"
                AutoGenerateColumns="False"
                CanUserAddRows="False"
                CanUserDeleteRows="False"
                CanUserResizeColumns="True"
                CanUserResizeRows="False"
                CanUserReorderColumns="True"
                CanUserSortColumns="False"
                GridLinesVisibility="All"
                HeadersVisibility="Column"
                IsReadOnly="True"
                MinHeight="360"
                ScrollViewer.HorizontalScrollBarVisibility="Auto"
                ScrollViewer.VerticalScrollBarVisibility="Auto">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Old name"
                        Binding="{Binding OldName}"/>
                    <DataGridTextColumn Header="New name"
                        Binding="{Binding NewName}"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
        
        <Button Content="Rename"
            Command="{Binding DoCommand}"
            Style="{DynamicResource {x:Static i:XButton.GreenButton}}"/>
    </Grid>
</i:AppToolView>